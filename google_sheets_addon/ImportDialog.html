<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <?!= HtmlService.createHtmlOutputFromFile('Stylesheet').getContent(); ?>
  </head>
  <body>
    <div id="fatalerror"></div>
<script type="text/javascript">
window.onerror = function CustomErrorHandler(msg, url, linenum) {
  document.getElementById('fatalerror').innerHTML = '<font style="color: #880000;">[FATAL]</font> A Javascript error occurred in ' + url + ' on line ' + linenum + '.  ' + msg;

  return false;
}
</script>

    <div>
      <div id="dialog-button-bar-scroll">
        <p>Select a JSON-Base64 (*.jb64) file to import its contents into a new sheet.</p>
        <div id="contentwrap" class="importresponse"></div>
      </div>
      <div class="block" id="dialog-button-bar">
        <button id="dialog-select-file-button" class="action">Select file</button>
        <button id="dialog-cancel-button" onclick="google.script.host.close()">Cancel</button>
      </div>
    </div>

    <input type="file" id="import_file" name="data" accept="application/jb64" style="display: none;" />

    <!-- Include the core support functions. -->
    <?!= HtmlService.createHtmlOutputFromFile('support').getContent(); ?>

    <!-- Include the import dialog functions. -->
    <?!= HtmlService.createHtmlOutputFromFile('ImportDialogJS').getContent(); ?>
  </body>
</html>
